<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RainCall+</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ğŸ“ {{ city }}</h1>
        <div class="pop-circle">
            <span class="number">{{ pop }}</span><span class="percent">%</span>
        </div>
        <p class="message">{{ message }}</p>
    </div>

    <script>
        // ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚“ã ç¬é–“ã«ä½ç½®æƒ…å ±ã‚’å–å¾—
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            
            // ã™ã§ã«URLã« latï¼ˆç·¯åº¦ï¼‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚ã—ãªã„ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰
            if (params.has('lat')) return;

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        // å–å¾—ã—ãŸç¾åœ¨åœ°ã‚’URLã«ãã£ã¤ã‘ã¦ã€è‡ªåˆ†è‡ªèº«ã«é€ã‚Šç›´ã™ï¼
                        window.location.href = `/?lat=${lat}&lon=${lon}`;
                    },
                    (error) => {
                        console.error("ä½ç½®æƒ…å ±ãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ", error);
                    }
                );
            }
        };
    </script>
</body>
</html>