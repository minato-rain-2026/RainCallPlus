<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RainCall+ | å¤©æ°—é€šçŸ¥ã‚¢ãƒ—ãƒª</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body { background: linear-gradient(180deg, #6dd5ed, #2193b0); min-height: 100vh; display: flex; align-items: center; justify-content: center; color: white; }
        .weather-card { background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); border-radius: 20px; padding: 40px; text-align: center; border: 1px solid rgba(255,255,255,0.3); }
        .pop-display { font-size: 5rem; font-weight: bold; }
    </style>
</head>
<body>
    <div class="weather-card shadow-lg">
        <h2 id="city">ğŸ“ {{ city }}</h2>
        <div class="pop-display">{{ pop }}%</div>
        <p class="fs-4">{{ message }}</p>
    </div>

    <script>
        // ãƒ–ãƒ©ã‚¦ã‚¶ã®ä½ç½®æƒ…å ±APIã‚’ä½¿ç”¨ã—ã¦åº§æ¨™ã‚’å–å¾—
        function getLocation() {
            const urlParams = new URLSearchParams(window.location.search);
            // ã™ã§ã«URLã«åº§æ¨™ãŒã‚ã‚‹å ´åˆã¯å†èª­ã¿è¾¼ã¿ã—ãªã„ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰
            if (!urlParams.has('lat')) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            const lat = position.coords.latitude;
                            const lon = position.coords.longitude;
                            // åº§æ¨™ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä»˜ã‘ã¦è‡ªåˆ†è‡ªèº«ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
                            window.location.href = `/?lat=${lat}&lon=${lon}`;
                        },
                        (error) => {
                            alert("ä½ç½®æƒ…å ±ã®å–å¾—ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚");
                        }
                    );
                }
            }
        }
        window.onload = getLocation;
    </script>
</body>
</html>